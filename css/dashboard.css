/* ========================================
   DASHBOARD.CSS - Version Finale (Structure Étages)
   ======================================== */

/* --- CONTAINER GLOBAL --- */
.container {
    display: flex;
    flex-direction: column;
    gap: 24px;
    padding-bottom: 40px;
}
/* On désactive le layout global précédent */
.dashboard-layout { display: contents; } 

/* === SECTION HAUTE (2 COLONNES) === */
.dashboard-top-section {
    display: grid;
    /* Gauche (KPI+Graph) flexible | Droite (Indices) fixe */
    grid-template-columns: 1fr 300px; 
    gap: 24px;
    /* Force la colonne indices à faire toute la hauteur de la colonne gauche */
    align-items: stretch; 
}

/* --- COLONNE GAUCHE --- */
.dashboard-left-column {
    display: flex;
    flex-direction: column;
    gap: 24px;
    min-width: 0;
}

/* --- COLONNE DROITE --- */
.dashboard-right-sidebar {
    /* Sticky pour suivre le scroll si la gauche est plus longue */
    position: sticky;
    top: 24px;
    height: calc(100vh - 48px); 
    display: flex;
    flex-direction: column;
}

/* Panneau Indices */
.dashboard-indices-panel-full {
    background: var(--bg-card);
    border-radius: 12px;
    border: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    padding: 16px;
    height: 100%; /* Remplit toute la hauteur disponible */
    overflow: hidden;
}
.indices-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    overflow-y: auto;
    flex: 1;
    padding-right: 4px;
    margin-top: 12px;
}
.indices-list::-webkit-scrollbar { width: 4px; }
.indices-list::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 2px; }


/* === BLOC 1 : KPI GRID === */
.dashboard-kpi-grid-v2 {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 16px;
}
/* Styles KPI (Inchangés - Copiez-collez) */
.kpi-card { background: var(--bg-card); padding: 16px; border-radius: 12px; border: 1px solid var(--border-color); display: flex; flex-direction: column; justify-content: space-between; min-height: 130px; transition: transform 0.2s, border-color 0.2s; }
.kpi-card:hover { border-color: var(--accent-blue); transform: translateY(-2px); }
.kpi-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
.kpi-label { font-size: 11px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
.kpi-icon { opacity: 0.5; }
.kpi-hero { grid-column: span 2; background: linear-gradient(135deg, var(--bg-card) 0%, rgba(59, 130, 246, 0.08) 100%); border: 1px solid rgba(59, 130, 246, 0.3); min-height: 140px; }
.kpi-hero .kpi-value { font-size: 32px; font-weight: 700; color: var(--text-primary); margin: 4px 0; }
.kpi-name-large { font-size: 15px; font-weight: 600; color: var(--text-primary); margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
.kpi-meta { font-size: 13px; display: flex; gap: 6px; align-items: center; margin-top: auto; }
.kpi-change { font-weight: 600; }
.kpi-change-pct { font-size: 12px; font-weight: 500; opacity: 0.9; }
.kpi-sector-details { display: flex; flex-direction: column; gap: 2px; margin-top: auto; }
.kpi-sector-value { font-size: 14px; font-weight: 700; color: var(--text-primary); }
.kpi-sector-pct { font-size: 11px; color: var(--text-muted); }
#dashboard-allocation-container { height: 100%; display: flex; flex-direction: column; }
.allocation-wrapper { display: flex; flex-direction: column; gap: 12px; height: 100%; width: 100%; }
.allocation-bar { display: flex; width: 100%; height: 6px; border-radius: 4px; overflow: hidden; background: rgba(255,255,255,0.05); margin-bottom: 4px; flex-shrink: 0; }
.alloc-segment { height: 100%; transition: width 0.5s ease; }
.allocation-list { display: flex; flex-direction: column; gap: 10px; flex: 1; justify-content: center; }
.alloc-row { display: flex; justify-content: space-between; align-items: center; font-size: 12px; width: 100%; }
.alloc-left { display: flex; align-items: center; gap: 8px; flex: 1; }
.alloc-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.alloc-pct { font-weight: 700; color: var(--text-primary); min-width: 45px; margin-right: 4px; }
.alloc-label { color: var(--text-muted); text-transform: uppercase; font-size: 10px; letter-spacing: 0.5px; font-weight: 600; white-space: nowrap; }
.alloc-right span { font-weight: 600; color: var(--text-primary); font-family: 'Inter', monospace; text-align: right; }


/* === BLOC 2 : SPLIT SECTION (GRAPH + INDICES) === */
.dashboard-split-section {
    display: grid;
    grid-template-columns: 1fr 300px; /* Graphique large + Indices fixes */
    gap: 24px;
    /* C'est la clé : STRETCH force les deux colonnes à avoir la même hauteur visuelle */
    align-items: stretch;
    
    /* On ne fixe plus de hauteur ici, c'est le contenu (le graph) qui décidera */
    height: auto; 
}

/* Partie Gauche : Graphique */
.dashboard-chart-section {
    background: var(--bg-card);
    border-radius: 12px;
    border: 1px solid var(--border-color);
    display: flex; 
    flex-direction: column; 
    overflow: hidden;
    
    /* NOUVELLE HAUTEUR : On augmente à 550px pour ne plus couper les infos */
    height: 550px; 
    min-height: 550px;
}

/* Partie Droite : Indices */
.dashboard-right-sidebar {
    /* On s'assure qu'il prend toute la hauteur définie par le voisin (le graph) */
    height: 100%; 
    display: flex;
    flex-direction: column;
}

.dashboard-indices-panel-full {
    background: var(--bg-card);
    border-radius: 12px;
    border: 1px solid var(--border-color);
    display: flex;
    flex-direction: column;
    padding: 16px;
    
    /* IMPORTANT : Prend 100% de la hauteur du parent (.dashboard-right-sidebar) */
    height: 100%; 
    overflow: hidden;
}

.indices-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
    overflow-y: auto; /* Active le scroll si la liste est plus longue que le graph */
    flex: 1; /* Prend tout l'espace disponible */
    padding-right: 4px;
    margin-top: 12px;
}
.indices-list::-webkit-scrollbar { width: 4px; }
.indices-list::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 2px; }

/* Ajustement interne du Graphique pour qu'il remplisse l'espace */
.chart-wrapper.tall {
    /* Le canvas prend l'espace restant, moins le header et le footer */
    flex: 1; 
    height: auto; /* On laisse flex gérer */
    min-height: 0; /* Important pour le resize du canvas */
    position: relative;
    padding: 10px 20px;
    background: transparent;
}

/* Le footer reste collé en bas */
.chart-stats-bar {
    margin: 0; 
    border: none; 
    border-top: 1px solid var(--border-color); 
    background: rgba(15, 20, 35, 0.5); 
    padding: 16px 24px; 
    display: flex; 
    align-items: center; 
    justify-content: space-between; 
    gap: 24px; 
    flex-wrap: wrap;
    flex-shrink: 0; /* Ne s'écrase pas */
}
/* ... (Styles Chart inchangés) ... */
.chart-header-mini { padding: 16px 24px; background: transparent; border-bottom: 1px solid rgba(255, 255, 255, 0.05); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 10px; }
.chart-title { display: flex; align-items: center; gap: 10px; font-size: 16px; font-weight: 600; color: var(--text-primary); margin: 0; }
.header-controls { display: flex; align-items: center; gap: 16px; }
.chart-controls-inline { display: flex; gap: 4px; background: var(--bg-secondary); padding: 2px; border-radius: 8px; border: 1px solid var(--border-color); }
.chart-controls-inline .period-btn { padding: 4px 12px; font-size: 11px; font-weight: 600; border: none; background: transparent; color: var(--text-secondary); border-radius: 6px; cursor: pointer; transition: all 0.2s; }
.chart-controls-inline .period-btn:hover { color: var(--text-primary); }
.chart-controls-inline .period-btn.active { background: var(--accent-blue); color: white; }
.benchmark-wrapper { position: relative; }
#benchmark-select { appearance: none; background-color: var(--bg-secondary); border: 1px solid var(--border-color); color: var(--text-secondary); padding: 4px 24px 4px 12px; border-radius: 6px; font-size: 11px; font-weight: 600; cursor: pointer; height: 26px; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='%239fa6bc' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 8px center; }
#benchmark-select:hover { border-color: var(--accent-blue); color: var(--text-primary); }
#benchmark-select:focus { outline: none; border-color: var(--accent-blue); }
.chart-wrapper.tall { height: 100%; min-height: 350px; position: relative; padding: 10px 20px; background: transparent; }
.chart-stats-bar { margin: 0; border: none; border-top: 1px solid var(--border-color); background: rgba(15, 20, 35, 0.5); padding: 16px 24px; display: flex; align-items: center; justify-content: space-between; gap: 24px; flex-wrap: wrap; }
.stat-group-1 { padding-right: 24px; border-right: 1px solid var(--border-color); min-width: 140px; flex-shrink: 0; }
.stat-group-2 { display: flex; gap: 24px; padding-right: 24px; border-right: 1px solid var(--border-color); flex-shrink: 0; }
.stat-group-3 { display: flex; gap: 32px; flex-grow: 1; justify-content: flex-end; }
.stat { display: flex; flex-direction: column; white-space: nowrap; }
.stat .label { font-size: 10px; color: var(--text-muted); text-transform: uppercase; margin-bottom: 4px; letter-spacing: 0.5px; font-weight: 600; }
.stat .value { font-size: 15px; font-weight: 700; color: var(--text-primary); font-family: 'Inter', monospace; }
.stat .pct { font-size: 12px; margin-left: 4px; opacity: 0.9; }
.stat-group-1 .value { font-size: 22px; margin-bottom: 2px; }
.stat-group-1 .pct { font-size: 14px; font-weight: 500; }

.section-title-right { font-size: 12px; font-weight: 600; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; margin: 0; }
.market-card { background: var(--bg-secondary); padding: 12px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.05); display: flex; flex-direction: column; justify-content: space-between; min-height: 80px; flex-shrink: 0; transition: all 0.2s ease; }
.market-card:hover { border-color: var(--accent-blue); transform: translateY(-2px); }
.market-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 6px; }
.market-name { font-size: 11px; font-weight: 700; color: var(--text-muted); text-transform: uppercase; }
.market-icon { font-size: 16px; opacity: 0.8; }
.market-price { font-size: 15px; font-weight: 700; color: var(--text-primary); font-family: 'Inter', monospace; margin-bottom: 2px; }
.market-change-row { display: flex; align-items: center; gap: 6px; font-size: 12px; font-weight: 600; }
.market-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.market-dot.open { background: #10b981; }
.market-dot.closed { background: #ef4444; }


/* === BLOC 3 : NEWS FEEDS (BAS) === */
.dashboard-feeds-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* 2 colonnes égales */
    gap: 24px;
    height: 500px; /* Hauteur fixe */
}

.feed-card {
    background: var(--bg-card);
    border: 1px solid var(--border-color);
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    height: 100%;
}

.feed-header {
    padding: 16px;
    border-bottom: 1px solid var(--border-color);
    display: flex; justify-content: space-between; align-items: center;
    background: rgba(255,255,255,0.02);
    flex-shrink: 0;
}
.feed-header h3 { font-size: 14px; font-weight: 600; margin: 0; display: flex; align-items: center; gap: 8px; }

.feed-content { flex: 1; overflow-y: auto; padding: 0; }
.feed-content::-webkit-scrollbar { width: 6px; }
.feed-content::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }

.news-item-compact { padding: 12px 16px; border-bottom: 1px solid rgba(255,255,255,0.05); cursor: pointer; transition: background 0.2s; }
.news-item-compact:last-child { border-bottom: none; }
.news-item-compact:hover { background: var(--bg-hover); }
.news-meta-row { display: flex; justify-content: space-between; margin-bottom: 6px; font-size: 10px; color: var(--text-muted); align-items: center; }
.news-title-compact { font-size: 12px; font-weight: 500; line-height: 1.4; color: var(--text-primary); }
.news-ticker-tag { background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px; color: var(--accent-blue); font-weight: 700; font-size: 9px; }
.btn-icon-small { background: none; border: none; color: var(--text-secondary); cursor: pointer; font-size: 12px; }
.btn-icon-small:hover { color: var(--text-primary); }
.twitter-feed-container { background: #000; padding: 0; }


/* === MODAL === */
.news-modal-content { max-width: 500px; background: var(--bg-card); border: 1px solid var(--border-color); box-shadow: 0 20px 50px rgba(0,0,0,0.5); }
.news-modal-ticker { background: var(--accent-blue); color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 700; }
.news-ai-badge { display: inline-flex; align-items: center; gap: 6px; background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; font-size: 10px; font-weight: 600; padding: 4px 10px; border-radius: 20px; margin-bottom: 12px; box-shadow: 0 2px 10px rgba(139, 92, 246, 0.3); }
.news-summary-text { font-size: 14px; color: var(--text-secondary); line-height: 1.7; background: rgba(255, 255, 255, 0.02); padding: 16px; border-radius: 8px; border: 1px solid var(--border-color); min-height: 100px; }
@keyframes pulse-text { 0% { opacity: 0.5; } 50% { opacity: 1; } 100% { opacity: 0.5; } }
.loading-text { animation: pulse-text 1.5s infinite; color: var(--text-muted); }

/* RESPONSIVE */
@media (max-width: 1200px) {
    .dashboard-top-section { grid-template-columns: 1fr; } /* Stack sur mobile */
    .dashboard-right-sidebar { position: static; height: auto; }
    .dashboard-indices-panel-full { height: auto; }
    .indices-list { flex-direction: row; overflow-x: auto; padding-bottom: 12px; }
    .market-card { min-width: 140px; }
    .dashboard-feeds-grid { grid-template-columns: 1fr; height: auto; }
    .feed-card { height: 400px; }
}
/* === OPENMOJI ICONS === */
/* À ajouter dans css/dashboard.css */

.market-icon img {
    width: 24px;
    height: 24px;
    vertical-align: middle;
    transition: transform 0.2s ease;
}

.market-card:hover .market-icon img {
    transform: scale(1.1) rotate(5deg);
}